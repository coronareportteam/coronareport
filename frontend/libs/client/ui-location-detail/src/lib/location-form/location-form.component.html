<form [formGroup]="formGroup" (ngSubmit)="onSubmit()">
  <mat-card class="form__card--small form__card--animated">
    <mat-card-header>
      <div mat-card-avatar class="header-image"></div>
      <mat-card-title>{{
        isNew ? ('LOCATION_FORM.NEUEN_ORT_ANLEGEN' | translate) : ('LOCATION_FORM.ORT_BEARBEITEN' | translate)
      }}</mat-card-title>
      <mat-card-subtitle>{{ 'LOCATION_FORM.PFLICHTEINGABEN_SIND_MARKIERT' | translate }}</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <mat-form-field class="full-width">
        <mat-label>{{ 'LOCATION_FORM.NAME' | translate }} *</mat-label>
        <input
          matInput
          [placeholder]="'LOCATION_FORM.NAME' | translate"
          formControlName="name"
          type="text"
          #name_input
          (blur)="trimValue(name_input)"
        />
        <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.name)">
          {{ validationErrorService.getErrorMessage(formGroup.controls.name, error) | async }}
        </mat-error>
      </mat-form-field>
      <fieldset class="mb-3">
        <legend>{{ 'LOCATION_FORM.ADRESSE' | translate }}</legend>
        <mat-form-field style="width: 70%">
          <input
            matInput
            [placeholder]="'LOCATION_FORM.STRASSE' | translate"
            formControlName="street"
            type="text"
            #street_input
            (blur)="trimValue(street_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.street)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.street, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field style="width: 30%">
          <input
            matInput
            [placeholder]="'LOCATION_FORM.HAUSNUMMER' | translate"
            maxlength="6"
            formControlName="houseNumber"
            type="text"
            #house_number_input
            (blur)="trimValue(house_number_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.houseNumber)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.houseNumber, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field style="width: 30%">
          <mat-label>{{ 'LOCATION_FORM.POSTLEITZAHL' | translate }} *</mat-label>
          <input
            matInput
            [placeholder]="'LOCATION_FORM.POSTLEITZAHL' | translate"
            formControlName="zipCode"
            type="text"
            #zip_code_input
            (blur)="trimValue(zip_code_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.zipCode)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.zipCode, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field style="width: 70%">
          <mat-label>{{ 'LOCATION_FORM.ORT' | translate }} *</mat-label>
          <input
            matInput
            [placeholder]="'LOCATION_FORM.ORT' | translate"
            formControlName="city"
            type="text"
            #city_input
            (blur)="trimValue(city_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.city)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.city, error) | async }}
          </mat-error>
        </mat-form-field>
      </fieldset>
      <fieldset class="mb-3" formGroupName="contactPerson">
        <legend>{{ 'LOCATION_FORM.KONTAKTMÃ–GLICHKEITEN' | translate }}</legend>
        <mat-form-field class="full-width" data-cy="location-form-phone">
          <input
            matInput
            [placeholder]="'LOCATION_FORM.ANSPRECHPARTNER' | translate"
            formControlName="contactPersonName"
            type="text"
            #contact_person_name_input
            (blur)="trimValue(contact_person_name_input)"
          />
          <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.contactPersonName)">
            {{ validationErrorService.getErrorMessage(formGroup.controls.contactPersonName, error) | async }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="full-width">
          <input
            matInput
            maxlength="17"
            minlength="5"
            [placeholder]="'LOCATION_FORM.TELEFONNUMMER' | translate"
            formControlName="contactPersonPhone"
            type="phone"
            #phone_input
            (blur)="trimValue(phone_input)"
          />
          <mat-error
            *ngFor="let error of validationErrorService.getErrorKeys(formGroup.get('contactPerson.contactPersonPhone'))"
          >
            {{
              validationErrorService.getErrorMessage(formGroup.get('contactPerson.contactPersonPhone'), error) | async
            }}
          </mat-error>
        </mat-form-field>
        <mat-form-field class="full-width">
          <input
            matInput
            [placeholder]="'LOCATION_FORM.E_MAIL' | translate"
            formControlName="contactPersonEmail"
            type="email"
            #email_input
            (blur)="trimValue(email_input)"
          />
          <mat-error
            *ngFor="let error of validationErrorService.getErrorKeys(formGroup.get('contactPerson.contactPersonEmail'))"
          >
            {{
              validationErrorService.getErrorMessage(formGroup.get('contactPerson.contactPersonEmail'), error) | async
            }}
          </mat-error>
        </mat-form-field>
      </fieldset>
      <mat-form-field class="full-width">
        <mat-label>{{ 'LOCATION_FORM.SONSTIGE_BEMERKUNGEN' | translate }}</mat-label>
        <textarea
          [mat-autosize]="true"
          [matAutosizeMinRows]="4"
          matInput
          formControlName="comment"
          [placeholder]="'LOCATION_FORM.WEITERE_KOMMENTARE_ODER_HINWEISE' | translate"
        ></textarea>
        <mat-hint align="start"
          ><strong>{{ 'LOCATION_FORM.WEITERE_KOMMENTARE_ODER_HINWEISE' | translate }}</strong>
        </mat-hint>
        <mat-error *ngFor="let error of validationErrorService.getErrorKeys(formGroup.controls.comment)">
          {{ validationErrorService.getErrorMessage(formGroup.controls.comment, error) | async }}
        </mat-error>
      </mat-form-field>
    </mat-card-content>
    <mat-card-actions>
      <qro-button data-cy="submit-button" [disabled]="formGroup.invalid || formGroup.pristine" [loading]="loading">
        {{ 'LOCATION_FORM.SPEICHERN' | translate }}
      </qro-button>
      <button type="button" mat-raised-button color="secondary" (click)="cancel()">
        {{ 'LOCATION_FORM.ABBRECHEN' | translate }}
      </button>
    </mat-card-actions>
  </mat-card>
</form>
